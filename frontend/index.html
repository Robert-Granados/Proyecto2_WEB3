<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard Scraper MercadoLibre CR</title>
  
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Bootstrap Iconos -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
  <!-- FullCalendar -->
  <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/main.min.css" rel="stylesheet" />
  <!--  Styles Personalisados-->
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <!-- Header con gradiente -->
  <header class="bg-gradient-primary shadow-lg">
    <div class="container-fluid py-4">
      <div class="row align-items-center">
        <div class="col-md-8">
          <h1 class="mb-0 text-white fw-bold">
            <i class="bi bi-graph-up-arrow me-3"></i>
            Dashboard Web Scraping MercadoLibre Costa Rica
          </h1>
        </div>
        <div class="col-md-4 text-md-end mt-3 mt-md-0">
          <div class="d-flex justify-content-end align-items-center gap-2">
            <!-- Botón que dispara la descarga del reporte PDF -->
            <button id="download-pdf-btn" class="btn btn-outline-light btn-sm">
              <i class="bi bi-download me-1"></i>
              Descargar reporte PDF
            </button>
            <span class="badge bg-success fs-6 px-3 py-2">
              <i class="bi bi-circle-fill pulse me-2"></i>
              Sistema Activo
            </span>
          </div>
        </div>
      </div>
    </div>
  </header>

  <main class="container-fluid py-4">
    <!-- Cards de resumen con iconos -->
    <section id="summary" class="row g-4 mb-4">
      <div class="col-lg-4 col-md-6">
        <div class="card card-hover border-0 shadow-lg h-100">
          <div class="card-body">
            <div class="d-flex justify-content-between align-items-center">
              <div>
                <h2 class="card-title text-muted mb-1 fs-6">Total productos</h2>
                <p id="total-products" class="display-4 fw-bold text-primary mb-0">0</p>
              </div>
              <div class="icon-box bg-primary bg-opacity-10 rounded-3 p-3">
                <i class="bi bi-box-seam fs-1 text-primary"></i>
              </div>
            </div>
            <div class="progress mt-3" style="height: 5px;">
              <div class="progress-bar bg-primary" role="progressbar" style="width: 100%"></div>
            </div>
          </div>
        </div>
      </div>

      <div class="col-lg-4 col-md-6">
        <div class="card card-hover border-0 shadow-lg h-100">
          <div class="card-body">
            <div class="d-flex justify-content-between align-items-center">
              <div>
                <h2 class="card-title text-muted mb-1 fs-6">Productos activos</h2>
                <p id="active-products" class="display-4 fw-bold text-success mb-0">0</p>
              </div>
              <div class="icon-box bg-success bg-opacity-10 rounded-3 p-3">
                <i class="bi bi-check-circle fs-1 text-success"></i>
              </div>
            </div>
            <div class="progress mt-3" style="height: 5px;">
              <div class="progress-bar bg-success" role="progressbar" style="width: 100%"></div>
            </div>
          </div>
        </div>
      </div>

      <div class="col-lg-4 col-md-6">
        <div class="card card-hover border-0 shadow-lg h-100">
          <div class="card-body">
            <div class="d-flex justify-content-between align-items-center">
              <div>
                <h2 class="card-title text-muted mb-1 fs-6">Eventos recientes</h2>
                <p id="recent-events-count" class="display-4 fw-bold text-warning mb-0">0</p>
              </div>
              <div class="icon-box bg-warning bg-opacity-10 rounded-3 p-3">
                <i class="bi bi-calendar-event fs-1 text-warning"></i>
              </div>
            </div>
            <div class="progress mt-3" style="height: 5px;">
              <div class="progress-bar bg-warning" role="progressbar" style="width: 100%"></div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Tablas con diseño -->
    <section id="tables" class="row g-4 mb-4">
      <div class="col-lg-8">
        <div class="card border-0 shadow-lg panel-card">
          <div class="card-header bg-transparent border-0 pt-4 pb-3">
            <h2 class="mb-0 fw-bold">
              <i class="bi bi-bag-check me-2 text-primary"></i>
              Productos
            </h2>
          </div>
          <div class="card-body">
            <div class="input-group mb-3 shadow-sm">
              <span class="input-group-text bg-light border-0">
                <i class="bi bi-search"></i>
              </span>
              <input id="product-search" class="form-control border-0" placeholder="Buscar por nombre..." />
            </div>
            <div class="table-responsive">
              <table id="products-table" class="table table-hover">
                <thead>
                <tr>
                  <th>Nombre</th>
                  <th>Imagen</th>
                  <th>Marca</th>
                  <th>Categoria</th>
                <th>Precio</th>
                <th>Estado</th>
                <th>Ultima vez visto</th>
                <th>Acciones</th>
                  </tr>
                </thead>
                <tbody></tbody>
              </table>
            </div>
          </div>
        </div>
      </div>

      <div class="col-lg-4">
        <div class="card border-0 shadow-lg panel-card">
          <div class="card-header bg-transparent border-0 pt-4 pb-3">
            <h2 class="mb-0 fw-bold">
              <i class="bi bi-file-earmark-text me-2 text-info"></i>
              Archivos
            </h2>
          </div>
          <div class="card-body">
            <div class="table-responsive">
              <table id="files-table" class="table table-hover table-sm">
                <thead>
                  <tr>
                <th>Archivo</th>
                <th>Hash</th>
                <th>Estado</th>
                <th>Última vez visto</th>
                <th>Acciones</th>
                  </tr>
                </thead>
                <tbody></tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Calendario-->
    <section id="calendar-section" class="card border-0 shadow-lg">
      <div class="card-header bg-transparent border-0 pt-4 pb-3">
        <h2 class="mb-0 fw-bold">
          <i class="bi bi-calendar3 me-2 text-danger"></i>
          Calendario de eventos
        </h2>
      </div>
      <div class="card-body">
        <div id="calendar"></div>
      </div>
    </section>
  </main>

  <footer class="bg-gradient-dark text-white-50 mt-5">
    <div class="container-fluid py-4">
      <div class="row align-items-center">
        <div class="col-md-6">
          <p class="mb-0">
            <i class="bi bi-code-slash me-2"></i>
            Proyecto Web Scraping MercadoLibre CR - UTN
          </p>
        </div>
        <div class="col-md-6 text-md-end mt-2 mt-md-0">
          <small>
            <i class="bi bi-clock me-1"></i>
            Última actualización: <span id="last-update">--</span>
          </small>
        </div>
      </div>
    </div>
  </footer>

  <!-- Modales para mostrar y editar registros-->
  <!-- Modal de visualización de producto -->
  <div class="modal fade" id="productViewModal" tabindex="-1" aria-labelledby="productViewModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable modal-fullscreen-sm-down">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="productViewModalLabel">Detalle del producto</h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body">
          <div id="product-view-image-container" class="text-center mb-3 product-view-image-container d-none">
            <img id="product-view-image" class="img-fluid rounded shadow-sm" alt="Imagen del producto" />
          </div>
          <dl class="row mb-0">
            <dt class="col-sm-4 text-truncate">Nombre</dt>
            <dd class="col-sm-8" id="product-view-name">-</dd>
            <dt class="col-sm-4">Marca</dt>
            <dd class="col-sm-8" id="product-view-brand">-</dd>
            <dt class="col-sm-4">Categoría</dt>
            <dd class="col-sm-8" id="product-view-category">-</dd>
            <dt class="col-sm-4">Precio</dt>
            <dd class="col-sm-8" id="product-view-price">-</dd>
            <dt class="col-sm-4">URL</dt>
            <dd class="col-sm-8">
              <a id="product-view-url" href="#" target="_blank" rel="noreferrer">-</a>
            </dd>
            <dt class="col-sm-4">Estado</dt>
            <dd class="col-sm-8" id="product-view-active">-</dd>
            <dt class="col-sm-4">Primera vez visto</dt>
            <dd class="col-sm-8" id="product-view-first">-</dd>
            <dt class="col-sm-4">Última vez visto</dt>
            <dd class="col-sm-8" id="product-view-last">-</dd>
          </dl>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal de edición de producto -->
  <div class="modal fade" id="productEditModal" tabindex="-1" aria-labelledby="productEditModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable modal-fullscreen-sm-down">
      <div class="modal-content">
        <form id="product-edit-form">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="productEditModalLabel">Editar producto</h1>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
          </div>
          <div class="modal-body">
            <input type="hidden" id="product-edit-id" />
            <div class="mb-3">
              <label for="product-edit-name" class="form-label">Nombre</label>
              <input type="text" class="form-control" id="product-edit-name" required />
            </div>
            <div class="mb-3">
              <label for="product-edit-brand" class="form-label">Marca</label>
              <input type="text" class="form-control" id="product-edit-brand" />
            </div>
            <div class="mb-3">
              <label for="product-edit-category" class="form-label">Categoría</label>
              <input type="text" class="form-control" id="product-edit-category" />
            </div>
            <div class="row">
              <div class="mb-3 col-md-6">
                <label for="product-edit-price" class="form-label">Precio</label>
                <input type="number" step="0.01" class="form-control" id="product-edit-price" />
              </div>
              <div class="mb-3 col-md-6">
                <label for="product-edit-currency" class="form-label">Moneda</label>
                <input type="text" class="form-control" id="product-edit-currency" />
              </div>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="product-edit-active" />
              <label class="form-check-label" for="product-edit-active">
                Producto activo
              </label>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-light" data-bs-dismiss="modal">Cerrar</button>
            <button type="submit" class="btn btn-warning">Guardar cambios</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Modal de visualización de archivo -->
  <div class="modal fade" id="fileViewModal" tabindex="-1" aria-labelledby="fileViewModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable modal-fullscreen-sm-down">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="fileViewModalLabel">Detalle del archivo</h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body">
          <dl class="row mb-0">
            <dt class="col-sm-4">Nombre</dt>
            <dd class="col-sm-8" id="file-view-name">-</dd>
            <dt class="col-sm-4">Tipo MIME</dt>
            <dd class="col-sm-8" id="file-view-mime">-</dd>
            <dt class="col-sm-4">URL</dt>
            <dd class="col-sm-8">
              <a id="file-view-url" href="#" target="_blank" rel="noreferrer">-</a>
            </dd>
            <dt class="col-sm-4">Ruta local</dt>
            <dd class="col-sm-8" id="file-view-local">-</dd>
            <dt class="col-sm-4">Estado</dt>
            <dd class="col-sm-8" id="file-view-active">-</dd>
            <dt class="col-sm-4">Última vez visto</dt>
            <dd class="col-sm-8" id="file-view-last">-</dd>
          </dl>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal de edición de archivo -->
  <div class="modal fade" id="fileEditModal" tabindex="-1" aria-labelledby="fileEditModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable modal-fullscreen-sm-down">
      <div class="modal-content">
        <form id="file-edit-form">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="fileEditModalLabel">Editar archivo</h1>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
          </div>
          <div class="modal-body">
            <input type="hidden" id="file-edit-id" />
            <div class="mb-3">
              <label for="file-edit-name" class="form-label">Nombre</label>
              <input type="text" class="form-control" id="file-edit-name" />
            </div>
            <div class="mb-3">
              <label for="file-edit-local" class="form-label">Ruta local</label>
              <input type="text" class="form-control" id="file-edit-local" />
            </div>
            <div class="mb-3">
              <label for="file-edit-mime" class="form-label">Tipo MIME</label>
              <input type="text" class="form-control" id="file-edit-mime" />
            </div>
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="file-edit-active" />
              <label class="form-check-label" for="file-edit-active">
                Archivo activo
              </label>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-light" data-bs-dismiss="modal">Cerrar</button>
            <button type="submit" class="btn btn-warning">Guardar cambios</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <!-- FullCalendar -->
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/main.global.min.js"></script>
  <!-- Scripts personalizados -->
  <script src="main.js"></script>
  <script src="results.js"></script>
  <script src="files.js"></script>
  <script src="calendar.js"></script>
  
  <script>
    // Actualizar timestamp
    document.getElementById('last-update').textContent = new Date().toLocaleString('es-CR');
  </script>
</body>
</html>
